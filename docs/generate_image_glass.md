# Overlay Image Generation

This script generates overlay images using two segmentation models. It performs the following steps:

1.  Loads the input image.
2.  Uses the first model to generate a mask for the input image.
3.  Uses the second model to refine the mask.
4.  Computes the largest segmentation from the refined mask.
5.  Generates a glass effect overlay on the original image using the computed segmentation.

### Usage

`python generate_image_glass.py input_image_path [--model1_ckpt MODEL1_CHECKPOINT] [--model2_ckpt MODEL2_CHECKPOINT] [--save_dir SAVE_DIR] [--device DEVICE] [--dilation_kernel_size DILATION_KERNEL_SIZE] [--blur_kernel_size BLUR_KERNEL_SIZE] [--rgba_color R G B A] [--opacity OPACITY]` 

-   `input_image_path`: Path to the input image.
-   `--model1_ckpt`: Path to the checkpoint of the first model. Default is "/home/shravan/documents/deeplearning/github/segmentation_models/checkpoints/20230823/model_20230823_133015/last.ckpt".
-   `--model2_ckpt`: Path to the checkpoint of the second model. Default is "/home/shravan/documents/deeplearning/github/alpha_matte_segmentation/trimap_generation/checkpoints//20240102/model_20240102_155705/last.ckpt".
-   `--save_dir`: Directory to save the overlay images. Default is "./infer_and_postprocess".
-   `--device`: Device to use (cuda or cpu). Default is cuda if available, otherwise cpu.
-   `--dilation_kernel_size`: Size of the dilation kernel for largest segmentation computation. Default is 9.
-   `--blur_kernel_size`: Size of the blur kernel for largest segmentation computation. Default is 1.
-   `--rgba_color`: RGBA color for the glass effect. Default is (162, 194, 194, 0).
-   `--opacity`: Opacity for the glass effect. Default is 120.

Example:

`python generate_image_glass.py input.jpg --model1_ckpt model1.ckpt --model2_ckpt model2.ckpt --save_dir output --device cuda --dilation_kernel_size 9 --blur_kernel_size 1 --rgba_color 162 194 194 0 --opacity 120`



## Return Values
The `generate_overlay_images` function returns a dictionary containing paths to various intermediate and final images generated during the overlay image generation process. The keys and their corresponding descriptions are as follows:

-   `original_image_path`: Path to the original input image.
-   `pred_mask1_path`: Path to the predicted mask generated by the first model.
-   `pred_mask2_path`: Path to the refined mask generated by the second model.
-   `temp_segmentation_path`: Path to the temporary segmentation image created during processing.
-   `largest_segmentation_path`: Path to the final largest segmentation image.
-   `transparent_image_path`: Path to the image with a transparent overlay.
-   `glass_image_path`: Path to the final image with a glass effect overlay.

These paths can be used to access and further analyze the generated images as needed.